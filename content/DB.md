### 数据库
- MySQL引擎  

MyISAM:不支持事务/行级锁/外键,一般来说MyISAM查询效率高,但实际上此引擎已被逐渐放弃(频繁读操作不如存储在缓存);  

InnoDB:支持事务/行级锁/外键,但不保存表的具体行数,执行select count(*) from table时需要全表扫描.  

注意:MySQL5.5后默认引擎为InnoDB,MySQL5.7开始InnoDB支持全文索引,今后将放弃MyISAM.  

- CRUD      

select fields from table;  
insert into table() values();  
update from table set fields=xxx where id=xx;  
delete table where id=xx;  

- 三大范式  

第一范式:表字段不可再分,例如地址字段就具有值域可分,因此具有该字段的表就不符合第一范式,需要拆分字段;  

第二范式:非主属性(即不属于候选码中的字段)应完全依赖候选码(此时候选码是复合的,即两个字段确定唯一行),不允许出现单一候选码依赖,因此需要进行表分解;    

第三范式:不允许存在传递依赖,非主属性都应该直接依赖候选码,例如有r(R)=(A,B,C),F={A->B,B->C},A为候选码,若要符合3NF,则需要进行表分解,即r1(R)=(A,B),r2(R)=(B,C);    

需要注意:3NF⊂2NF⊂1NF,即满足3NF的前提是满足2NF,满足2NF的前提是满足1NF.   

- 乐观锁 & 悲观锁  

乐观锁:认为外界事务的访问是无害的,一致性不会被破坏,因此仅仅在事务结束后对数据库的一致性进行检测;    

悲观锁:认为数据库的一致性总会受到破坏,因此在事务访问数据对象前必须采取一定措施加以控制,只有得到访问许可,才能访问数据对象.

- 事务  

事务:具有完整逻辑意义的数据库操作序列的集合.对于DBMS而言,事务则是一个读写操作序列,这些操作是一个不可分割的逻辑工作单元,
要么都做,要么都不做.  

事务提交(commit):将成功完成的事务的执行结果永久化,并释放事务占有的全部资源.  
事务回滚(rollback):中止当前事务、撤销其对数据库所做的更新,并释放事务占有的全部资源.

事务并发执行带来的影响:  
①脏读:一个事务读取了另一个事务未提交的且被撤销的数据;  
②不可重复读:事务两次从数据库中读取的数据值不同;  
③幻读:事务两次从数据库中读取的记录数不同(变多或变少);  
④丢失更新:多个事务都读取了同一数据值并修改,最后提交的事务的执行结果覆盖了前面事务提交的执行结果.

- ACID  

原子性(Atomicity):一组数据库操作(事务)要么全部执行,要么都不执行;  
一致性(Consistency):一个单独执行的事务应保证其执行结果的一致性,即总是将数据库从一个一致性状态到达另一个一致性状态;    
隔离性(Isolation):当多个事务并发执行时,一个事务的执行不能影响另一个事务,即并发执行的各个事务不能相互干扰;    
持久性(Durability):一个事务成功提交后,它对数据库的改变必须是永久性的,即使随后系统出现故障也不会受到影响.    

- 隔离等级  

未提交读:一个事务可读取到另一个事务未提交的数据,这是最低的隔离等级,会导致脏读、不可重复读、幻读;  

提交读:一个事务只能读取到其他事务提交后的数据,这是很多数据库默认的隔离等级,解决了脏读,但会导致不可重复读、幻读;  

可重复读:一个事务可以重复读取某条数据值,不会发生数据前后读取,但值不一致的情况.解决了脏读,不可重复读的缺陷,无法解决幻读.是MySQL默认的隔离等级;    

串行化:事务将被同步串行化执行,解决了脏读、不可重复读、幻读,但性能大大下降,一般不会使用该隔离等级.

- 索引  

分为顺序索引和散列索引.  
顺序索引:    

B树:

B+树:  

- SQL优化

①合理建立索引  
②不准在条件语句的字段属性上使用函数(全表扫描)  
③禁止使用select *,只读取需要的字段(全表扫描)  
④禁止负向查询以及左%模糊查询,例如NOT != not in等(全表扫描)    
⑤join多表连接数尽可能少    
⑥......
  
- SQL注入  

- 锁相关  

- 高并发减库存  

- 分库分表    

水平拆分:  

垂直拆分:  

事务问题:  

- 主备同步      

执行复制的从数据库会连接上主数据库,接收主数据库的整个初始副本.每当主数据库执行 写命令时,都会被发送给所有连接着的从数据库执行,从而实时更新数据库数据集.避免对主数据库的 集中式访问.  
